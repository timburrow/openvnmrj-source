********************************
recon_all - image reconstruction
********************************

Definitions
--------------
EPI == echo planar imaging
FSE == fast spin echo
GEMS == gradient echo multi-slice
SEMS == spin echo multi-slice

Introduction
----------------
The purpose of "recon_all" is to integrate the reconstruction of 
images from a multitude of sequences and arraying situations in a
single C function, callable through Vnmrbg, which bypasses the fid
file reformatting used by the epi processing macros (eg, "flashc").
As such, it must accomodate the following:

- raw data filtering (windowing)
- EPI phase correction
- view sorting for EPI and FSE
- multi-shot acquisitions
- multi-slice acquisitions
- phase compression 
- slice compression
- multiple receivers
- multiple averages
- half Fourier reconstruction
- navigator echo corrections
- non-Cartesian k-space acquisitions (eg, spiral imaging)


Interface
-----------
recon_all is invoked directly on the vnmrj (or vnmr) command line,
simply as "recon_all". It operates on the data in the current
experiment; therefore, a user wishing to reconstruct  images from
a saved study must use the "rt" command to read the appropriate
fid and parameter files into the current experiment.

The 3 pieces of information that the user can modify with recon_all
are 1) the directory to which images are written,  2) the type of
phase correction (if applicable), and 3) the choice of windowing
function applied to raw data (if any). For the first two, there are
3 ways to communicate these choices to recon_all (in order of precedence):

- command line arguments, exemplfied by :
  "recon_all("/usr/vnmrsys/exp4/myimages"," QUADRATIC"), which directs
recon_all to write to the directory specified by the first argument,
and to use quadratic fitting for the phase correction. NB: for command
line use only, the full path of the image directory must be given.
This is to allow the command line form of recon_all to accept the
image directory path generated by the macro wexp.

- vnmrj parameters. The user can create and/or modify "epi_images",
the directory to contain resulting images (NB: relative path from
current directory) and "epi_pc". The possible values for the latter
are OFF,  POINTWISE, LINEAR, QUADRATIC, CENTER_PAIR, or PAIRWISE.

- editing a resource file called "recon_all.rsc". This file should
reside in the current expieriment directory. A sample of this file's
contents is:

image directory=myimages
phase correction=POINTWISE

- if neither the vnmr parameters nor the resource file exist, recon_all
will operate with the following defaults: image directory is "recon"
and phase correction (if applicable) is POINTWISE.

For setting the choice of data windowing function, a vnmrj parameter
is used. The name of this parameter is "recon_window". It is first
created by the user ("create('recon_window','string)"), and then set
("recon_window='gaussian' "). The recognized ooptions for this are:
OFF, NOFILTER (same as "OFF"), GAUSSIAN, HANN, HAMMING, and BLACKMANN.
 The Gaussian window assumes an alpha = 2.5 in its definition:
	
			w(j) = exp( -2*(alpha)^2/N^2 * (j-N/2)^2.

The remaining window functions are as defined below:

Blackmann:		w(j) = 0.42 - 0.5*cos(2PI*j/N) + 0.08*cos(4PI*j/N)
Hann: 			w(j) = 0.5*(1 - cos(2PI*j/N)
Hamming: 		w(j) = 0.54 - 0.46*cos(2PI*j/N)



Aside from command line useage, recon_all is intended to become integrated
with the world of macro-based processing through its inclusion in wexp.
