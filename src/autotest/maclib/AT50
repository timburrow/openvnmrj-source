"macro AT50"
"AT50" "Gaussian Excitation Profile  "

if (at_cycletest='yy') then ATnext return endif  "no need to repeat "

"Test performed with waveform generator if present, otherwise by pulse "
"is generated by pulse programmer as series of power/phase statements  "

if ($#=0) then
   ATrtp('standard')
   text('Gaussian Pulse Excitation Profile')
   at_currenttest='gauss_accuracy_ch1'
   array('tof',100,tof-250,5)
   seqfil='sh2pul' av
   pwpat='hard' p1pat='gauss' p1=14000 pw=0 tpwr=-15
   wnt='ATwft if (celem>50) then select(50) vsadj else select(1) vsadj(5) endif dssh dtext'
   wexp='AT50(`PART1`)'
   ATcycle
   au
   write('line3','Gaussian Excitation Profile ')
   dps
elseif ($1='PART1') then
  wft

 ATsvf
 if (at_plotauto='y') then
   if (at_printparams='y') then
     dn2='' pap ATpltext
     pps(120,0,wcmax-120,90) ATpage
   endif 
      pl('all','dodc')   "does plall for all data sets"
   pltext(0,wc2max-2) ATpage
 endif
 vs=vs*10 atext('vertical scale x10')
 if (at_plotauto='y') then
      pl('all','dodc')   "does plall for all data sets"
   pltext(0,wc2max-2) ATpage('gauss_accuracy_ch1_x10')
 endif

ATnext
endif
